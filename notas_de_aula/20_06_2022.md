# Linguagem de montagem 

## Relembrando

Na última aula vimos:
- Instruções aritméticas
  - Exemplos: add, sub e mul. 
    - Sintaxe: add $t0, $t1, $t2 # t0 = t1 + t2

- Simulador que utilizaremos: SPIM
- Tabela de registradores (32 registrados na arquitetura MIPS)
- Pseudo instruções
- Estrutura de um programa

## System calls (syscalls)

São chamadas a tarefas, feitas a nível lógico pelo processador, executadas por softwares de sistema (sistema operacional, por exemplo). 

Como fazer uma syscall: 
- Carregar em $v0 o código da syscall; 
- Carregar os argumentos necessários em $a0 a $a3;
- Executar a instrução `syscall`;
- Obtém o resultado, se aplicável, em $v0.

Uma tabela com os códigos das principais syscalls está disponível na página A-44 do 5ª edição do livro texto. 

Exemplo: Imprimir o inteiro do registrador $s0 na tela.
```
.text:
    main:
        addi $v0, $zero, 1 # Código 1 imprime um inteiro na tela.
        addi $a0, $s0, 0 # Guardando o valor de s0 em a0.
        syscall # Imprime o inteiro na tela
```

## Rótulos 

Um programa é um *vetor de instruções*. Cada instrução ocupa uma posição na memória (sequencial). Quando queremos acessar determinada instrução, pelo seu endereço, podemos usar *rótulos*. 

Exemplo: 

    ``` 
    imprime_inteiro: # Rótulo.
        li $v0, 1
        move $a0, $s0
        syscall
    ``` 

## Estrutura do programa

``` 
    .data: 
ola: .asciiz "Ola Mundo\n" #O processador criará a string na memória e 'ola' é um rótulo para a primeira posição de memória ocupada pela string. 
    .text:
    main: 
        li $v0, 4 #Código da syscall.
        la $a0, ola # Passa o endereço da string a ser impressa. 
        syscall 

        li $v0, 10
        syscall # Encerra o programa (return 0).
```

## Acesso à memória

| Endereço de memória | Célula |
| --- | --- |
| 0 | |
| 1 | |
| 2 | |
| 3 | |
| 4 | |
| ... | |

Cada célula de memória armazena 1 byte (8 bits). 

Por que o byte? É o tamanho de um inteiro curto ou caractere, e é um divisor do tamanho de outros tipos de dados. 

- Blocos de 4 bytes (32 bits) são muito utilizados. 
- Um dado sempre ocupa um endereço múltiplo de 4 (restrição de alinhamento).

